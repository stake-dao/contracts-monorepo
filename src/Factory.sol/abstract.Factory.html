<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Factory - Stake DAO Staking v2</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../book.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">README</a></li><li class="chapter-item expanded "><a href="../../src/integrations/index.html"><strong aria-hidden="true">1.</strong> integrations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/integrations/curve/index.html"><strong aria-hidden="true">1.1.</strong> curve</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/integrations/curve/L2/index.html"><strong aria-hidden="true">1.1.1.</strong> L2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/integrations/curve/L2/ConvexSidecarFactoryL2.sol/contract.ConvexSidecarFactoryL2.html"><strong aria-hidden="true">1.1.1.1.</strong> ConvexSidecarFactoryL2</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/L2/ConvexSidecarL2.sol/contract.ConvexSidecarL2.html"><strong aria-hidden="true">1.1.1.2.</strong> ConvexSidecarL2</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/L2/CurveFactoryL2.sol/contract.CurveFactoryL2.html"><strong aria-hidden="true">1.1.1.3.</strong> CurveFactoryL2</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/L2/CurveStrategyL2.sol/contract.CurveStrategyL2.html"><strong aria-hidden="true">1.1.1.4.</strong> CurveStrategyL2</a></li></ol></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/ConvexSidecar.sol/contract.ConvexSidecar.html"><strong aria-hidden="true">1.1.2.</strong> ConvexSidecar</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/ConvexSidecarFactory.sol/contract.ConvexSidecarFactory.html"><strong aria-hidden="true">1.1.3.</strong> ConvexSidecarFactory</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/CurveFactory.sol/contract.CurveFactory.html"><strong aria-hidden="true">1.1.4.</strong> CurveFactory</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/CurveStrategy.sol/contract.CurveStrategy.html"><strong aria-hidden="true">1.1.5.</strong> CurveStrategy</a></li><li class="chapter-item expanded "><a href="../../src/integrations/curve/OnlyBoostAllocator.sol/contract.OnlyBoostAllocator.html"><strong aria-hidden="true">1.1.6.</strong> OnlyBoostAllocator</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../src/interfaces/index.html"><strong aria-hidden="true">2.</strong> interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/interfaces/IAccountant.sol/interface.IAccountant.html"><strong aria-hidden="true">2.1.</strong> IAccountant</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IAllocator.sol/interface.IAllocator.html"><strong aria-hidden="true">2.2.</strong> IAllocator</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IBalanceProvider.sol/interface.IBalanceProvider.html"><strong aria-hidden="true">2.3.</strong> IBalanceProvider</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IFactory.sol/interface.IFactory.html"><strong aria-hidden="true">2.4.</strong> IFactory</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IProtocolController.sol/interface.IProtocolController.html"><strong aria-hidden="true">2.5.</strong> IProtocolController</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IRewardReceiver.sol/interface.IRewardReceiver.html"><strong aria-hidden="true">2.6.</strong> IRewardReceiver</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IRewardVault.sol/interface.IRewardVault.html"><strong aria-hidden="true">2.7.</strong> IRewardVault</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IRouter.sol/interface.IRouter.html"><strong aria-hidden="true">2.8.</strong> IRouter</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IRouterModule.sol/interface.IRouterModule.html"><strong aria-hidden="true">2.9.</strong> IRouterModule</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/ISidecar.sol/interface.ISidecar.html"><strong aria-hidden="true">2.10.</strong> ISidecar</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/ISidecarFactory.sol/interface.ISidecarFactory.html"><strong aria-hidden="true">2.11.</strong> ISidecarFactory</a></li><li class="chapter-item expanded "><a href="../../src/interfaces/IStrategy.sol/interface.IStrategy.html"><strong aria-hidden="true">2.12.</strong> IStrategy</a></li></ol></li><li class="chapter-item expanded "><a href="../../src/libraries/index.html"><strong aria-hidden="true">3.</strong> libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/libraries/ImmutableArgsParser.sol/library.ImmutableArgsParser.html"><strong aria-hidden="true">3.1.</strong> ImmutableArgsParser</a></li></ol></li><li class="chapter-item expanded "><a href="../../src/merkl/index.html"><strong aria-hidden="true">4.</strong> merkl</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/merkl/UniversalBoostRegistry.sol/contract.UniversalBoostRegistry.html"><strong aria-hidden="true">4.1.</strong> UniversalBoostRegistry</a></li></ol></li><li class="chapter-item expanded "><a href="../../src/router/index.html"><strong aria-hidden="true">5.</strong> router</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../src/router/RouterIdentifierMapping.sol/library.RouterIdentifierMapping.html"><strong aria-hidden="true">5.1.</strong> RouterIdentifierMapping</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleClaim.sol/contract.RouterModuleClaim.html"><strong aria-hidden="true">5.2.</strong> RouterModuleClaim</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleDeposit.sol/contract.RouterModuleDeposit.html"><strong aria-hidden="true">5.3.</strong> RouterModuleDeposit</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleMigrationCurve.sol/contract.RouterModuleMigrationCurve.html"><strong aria-hidden="true">5.4.</strong> RouterModuleMigrationCurve</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleMigrationStakeDAOV1.sol/interface.IVault.html"><strong aria-hidden="true">5.5.</strong> IVault</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleMigrationStakeDAOV1.sol/contract.RouterModuleMigrationStakeDAOV1.html"><strong aria-hidden="true">5.6.</strong> RouterModuleMigrationStakeDAOV1</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleMigrationYearn.sol/contract.RouterModuleMigrationYearn.html"><strong aria-hidden="true">5.7.</strong> RouterModuleMigrationYearn</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleMigrationYearn.sol/interface.IYearnVault.html"><strong aria-hidden="true">5.8.</strong> IYearnVault</a></li><li class="chapter-item expanded "><a href="../../src/router/RouterModuleWithdraw.sol/contract.RouterModuleWithdraw.html"><strong aria-hidden="true">5.9.</strong> RouterModuleWithdraw</a></li></ol></li><li class="chapter-item expanded "><a href="../../src/Accountant.sol/contract.Accountant.html"><strong aria-hidden="true">6.</strong> Accountant</a></li><li class="chapter-item expanded "><a href="../../src/Allocator.sol/contract.Allocator.html"><strong aria-hidden="true">7.</strong> Allocator</a></li><li class="chapter-item expanded "><a href="../../src/Factory.sol/abstract.Factory.html" class="active"><strong aria-hidden="true">8.</strong> Factory</a></li><li class="chapter-item expanded "><a href="../../src/ProtocolContext.sol/contract.ProtocolContext.html"><strong aria-hidden="true">9.</strong> ProtocolContext</a></li><li class="chapter-item expanded "><a href="../../src/ProtocolController.sol/contract.ProtocolController.html"><strong aria-hidden="true">10.</strong> ProtocolController</a></li><li class="chapter-item expanded "><a href="../../src/RewardReceiver.sol/contract.RewardReceiver.html"><strong aria-hidden="true">11.</strong> RewardReceiver</a></li><li class="chapter-item expanded "><a href="../../src/RewardReceiverL2.sol/contract.RewardReceiverL2.html"><strong aria-hidden="true">12.</strong> RewardReceiverL2</a></li><li class="chapter-item expanded "><a href="../../src/RewardVault.sol/contract.RewardVault.html"><strong aria-hidden="true">13.</strong> RewardVault</a></li><li class="chapter-item expanded "><a href="../../src/Router.sol/contract.Router.html"><strong aria-hidden="true">14.</strong> Router</a></li><li class="chapter-item expanded "><a href="../../src/Sidecar.sol/abstract.Sidecar.html"><strong aria-hidden="true">15.</strong> Sidecar</a></li><li class="chapter-item expanded "><a href="../../src/SidecarFactory.sol/abstract.SidecarFactory.html"><strong aria-hidden="true">16.</strong> SidecarFactory</a></li><li class="chapter-item expanded "><a href="../../src/Strategy.sol/abstract.Strategy.html"><strong aria-hidden="true">17.</strong> Strategy</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Stake DAO Staking v2</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/stake-dao/contracts-monorepo" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="factory"><a class="header" href="#factory">Factory</a></h1>
<p><a href="https://github.com/stake-dao/contracts-monorepo/blob/e0bd40c65ca6ae188111c58a3714bafb88f7ad6b/src/Factory.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="/src/ProtocolContext.sol/contract.ProtocolContext.html">ProtocolContext</a></p>
<p><strong>Author:</strong>
Stake DAO</p>
<p>Factory is an abstract base contract for implementing protocol-specific vault factories.
It provides core functionality for creating and managing vaults across different protocols,
including deploying vaults and reward receivers for protocol gauges, validating gauges and tokens,
registering vaults with the protocol controller, and setting up reward tokens for vaults.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>
<p>github: @stake-dao</p>
</li>
<li>
<p>contact: contact@stakedao.org</p>
</li>
</ul>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="reward_vault_implementation"><a class="header" href="#reward_vault_implementation">REWARD_VAULT_IMPLEMENTATION</a></h3>
<p>Reward vault implementation address</p>
<p><em>The implementation contract that will be cloned for each new vault</em></p>
<pre><code class="language-solidity">address public immutable REWARD_VAULT_IMPLEMENTATION;
</code></pre>
<h3 id="reward_receiver_implementation"><a class="header" href="#reward_receiver_implementation">REWARD_RECEIVER_IMPLEMENTATION</a></h3>
<p>Reward receiver implementation address</p>
<p><em>The implementation contract that will be cloned for each new reward receiver</em></p>
<pre><code class="language-solidity">address public immutable REWARD_RECEIVER_IMPLEMENTATION;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<p>Initializes the factory with protocol controller, reward token, and vault implementation</p>
<pre><code class="language-solidity">constructor(
    address _protocolController,
    address _vaultImplementation,
    address _rewardReceiverImplementation,
    bytes4 _protocolId,
    address _locker,
    address _gateway
) ProtocolContext(_protocolId, _protocolController, _locker, _gateway);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_protocolController</code></td><td><code>address</code></td><td>Address of the protocol controller</td></tr>
<tr><td><code>_vaultImplementation</code></td><td><code>address</code></td><td>Address of the reward vault implementation</td></tr>
<tr><td><code>_rewardReceiverImplementation</code></td><td><code>address</code></td><td>Address of the reward receiver implementation</td></tr>
<tr><td><code>_protocolId</code></td><td><code>bytes4</code></td><td>Protocol identifier</td></tr>
<tr><td><code>_locker</code></td><td><code>address</code></td><td>Address of the locker</td></tr>
<tr><td><code>_gateway</code></td><td><code>address</code></td><td>Address of the gateway</td></tr>
</tbody></table>
</div>
<h3 id="createvault"><a class="header" href="#createvault">createVault</a></h3>
<p>Create a new vault for a given gauge</p>
<p><em>Deploys a vault and reward receiver for the gauge, registers them, and sets up reward tokens</em></p>
<p><strong>Notes:</strong></p>
<ul>
<li>
<p>throws: InvalidGauge If the gauge is not valid</p>
</li>
<li>
<p>throws: InvalidDeployment If the deployment is not valid</p>
</li>
<li>
<p>throws: GaugeAlreadyUsed If the gauge has already been used</p>
</li>
</ul>
<pre><code class="language-solidity">function createVault(address gauge) public virtual returns (address vault, address rewardReceiver);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>vault</code></td><td><code>address</code></td><td>Address of the deployed vault</td></tr>
<tr><td><code>rewardReceiver</code></td><td><code>address</code></td><td>Address of the deployed reward receiver</td></tr>
</tbody></table>
</div>
<h3 id="syncrewardtokens"><a class="header" href="#syncrewardtokens">syncRewardTokens</a></h3>
<p>Sync reward tokens for a gauge</p>
<p><em>Updates the reward tokens for an existing vault</em></p>
<p><strong>Note:</strong>
throws: InvalidGauge If the gauge is not valid or has no associated vault</p>
<pre><code class="language-solidity">function syncRewardTokens(address gauge) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
</tbody></table>
</div>
<h3 id="_getasset"><a class="header" href="#_getasset">_getAsset</a></h3>
<p>Get the asset address from a gauge</p>
<p><em>Must be implemented by derived factories to handle protocol-specific asset retrieval</em></p>
<pre><code class="language-solidity">function _getAsset(address gauge) internal view virtual returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the asset associated with the gauge</td></tr>
</tbody></table>
</div>
<h3 id="_isvaliddeployment"><a class="header" href="#_isvaliddeployment">_isValidDeployment</a></h3>
<p>Check if a deployment is valid</p>
<p><em>Can be overridden by derived factories to add additional deployment validation</em></p>
<pre><code class="language-solidity">function _isValidDeployment(address) internal view virtual returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the deployment is valid, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="_initializevault"><a class="header" href="#_initializevault">_initializeVault</a></h3>
<p>Initialize the vault</p>
<pre><code class="language-solidity">function _initializeVault(address vault, address asset, address gauge) internal virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>vault</code></td><td><code>address</code></td><td>Address of the vault</td></tr>
<tr><td><code>asset</code></td><td><code>address</code></td><td>Address of the asset</td></tr>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
</tbody></table>
</div>
<h3 id="_registervault"><a class="header" href="#_registervault">_registerVault</a></h3>
<p>Register the vault in the protocol controller</p>
<pre><code class="language-solidity">function _registerVault(address gauge, address vault, address asset, address rewardReceiver) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
<tr><td><code>vault</code></td><td><code>address</code></td><td>Address of the vault</td></tr>
<tr><td><code>asset</code></td><td><code>address</code></td><td>Address of the asset</td></tr>
<tr><td><code>rewardReceiver</code></td><td><code>address</code></td><td>Address of the reward receiver</td></tr>
</tbody></table>
</div>
<h3 id="_setuprewardtokens"><a class="header" href="#_setuprewardtokens">_setupRewardTokens</a></h3>
<p>Setup reward tokens for the vault</p>
<p><em>Must be implemented by derived factories to handle protocol-specific reward token setup</em></p>
<pre><code class="language-solidity">function _setupRewardTokens(address vault, address gauge, address rewardReceiver) internal virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>vault</code></td><td><code>address</code></td><td>Address of the vault</td></tr>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
<tr><td><code>rewardReceiver</code></td><td><code>address</code></td><td>Address of the reward receiver</td></tr>
</tbody></table>
</div>
<h3 id="_setrewardreceiver"><a class="header" href="#_setrewardreceiver">_setRewardReceiver</a></h3>
<p>Set the reward receiver for a gauge</p>
<p><em>Must be implemented by derived factories to handle protocol-specific reward receiver setup</em></p>
<pre><code class="language-solidity">function _setRewardReceiver(address gauge, address rewardReceiver) internal virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
<tr><td><code>rewardReceiver</code></td><td><code>address</code></td><td>Address of the reward receiver</td></tr>
</tbody></table>
</div>
<h3 id="_isvalidgauge"><a class="header" href="#_isvalidgauge">_isValidGauge</a></h3>
<p>Check if a gauge is valid</p>
<p><em>Must be implemented by derived factories to handle protocol-specific gauge validation</em></p>
<pre><code class="language-solidity">function _isValidGauge(address gauge) internal view virtual returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the gauge</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>isValid True if the gauge is valid</td></tr>
</tbody></table>
</div>
<h3 id="_isvalidtoken"><a class="header" href="#_isvalidtoken">_isValidToken</a></h3>
<p>Check if a token is valid as a reward token</p>
<p><em>Validates that the token is not zero address and not the main reward token</em></p>
<pre><code class="language-solidity">function _isValidToken(address token) internal view virtual returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>address</code></td><td>Address of the token</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>isValid True if the token is valid</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="vaultdeployed"><a class="header" href="#vaultdeployed">VaultDeployed</a></h3>
<p>Emitted when a new vault is deployed</p>
<pre><code class="language-solidity">event VaultDeployed(address vault, address asset, address gauge);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>vault</code></td><td><code>address</code></td><td>Address of the deployed vault</td></tr>
<tr><td><code>asset</code></td><td><code>address</code></td><td>Address of the underlying asset</td></tr>
<tr><td><code>gauge</code></td><td><code>address</code></td><td>Address of the associated gauge</td></tr>
</tbody></table>
</div>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="invalidgauge"><a class="header" href="#invalidgauge">InvalidGauge</a></h3>
<p>Error thrown when the gauge is not a valid candidate</p>
<pre><code class="language-solidity">error InvalidGauge();
</code></pre>
<h3 id="approvefailed"><a class="header" href="#approvefailed">ApproveFailed</a></h3>
<p>Error thrown when the approve fails</p>
<pre><code class="language-solidity">error ApproveFailed();
</code></pre>
<h3 id="invalidtoken"><a class="header" href="#invalidtoken">InvalidToken</a></h3>
<p>Error thrown when the token is not valid</p>
<pre><code class="language-solidity">error InvalidToken();
</code></pre>
<h3 id="invaliddeployment"><a class="header" href="#invaliddeployment">InvalidDeployment</a></h3>
<p>Error thrown when the deployment is not valid</p>
<pre><code class="language-solidity">error InvalidDeployment();
</code></pre>
<h3 id="alreadydeployed"><a class="header" href="#alreadydeployed">AlreadyDeployed</a></h3>
<p>Error thrown when the gauge has been already used</p>
<pre><code class="language-solidity">error AlreadyDeployed();
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../src/Allocator.sol/contract.Allocator.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../src/ProtocolContext.sol/contract.ProtocolContext.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../src/Allocator.sol/contract.Allocator.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../src/ProtocolContext.sol/contract.ProtocolContext.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../solidity.min.js"></script>


    </div>
    </body>
</html>
