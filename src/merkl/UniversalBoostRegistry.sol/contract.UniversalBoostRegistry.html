<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>UniversalBoostRegistry - Stake DAO Staking v2</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../book.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../index.html">README</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/index.html"><strong aria-hidden="true">1.</strong> integrations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/integrations/curve/index.html"><strong aria-hidden="true">1.1.</strong> curve</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/integrations/curve/L2/index.html"><strong aria-hidden="true">1.1.1.</strong> L2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/integrations/curve/L2/ConvexSidecarFactoryL2.sol/contract.ConvexSidecarFactoryL2.html"><strong aria-hidden="true">1.1.1.1.</strong> ConvexSidecarFactoryL2</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/L2/ConvexSidecarL2.sol/contract.ConvexSidecarL2.html"><strong aria-hidden="true">1.1.1.2.</strong> ConvexSidecarL2</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/L2/CurveFactoryL2.sol/contract.CurveFactoryL2.html"><strong aria-hidden="true">1.1.1.3.</strong> CurveFactoryL2</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/L2/CurveStrategyL2.sol/contract.CurveStrategyL2.html"><strong aria-hidden="true">1.1.1.4.</strong> CurveStrategyL2</a></li></ol></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/ConvexSidecar.sol/contract.ConvexSidecar.html"><strong aria-hidden="true">1.1.2.</strong> ConvexSidecar</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/ConvexSidecarFactory.sol/contract.ConvexSidecarFactory.html"><strong aria-hidden="true">1.1.3.</strong> ConvexSidecarFactory</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/CurveFactory.sol/contract.CurveFactory.html"><strong aria-hidden="true">1.1.4.</strong> CurveFactory</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/CurveStrategy.sol/contract.CurveStrategy.html"><strong aria-hidden="true">1.1.5.</strong> CurveStrategy</a></li><li class="chapter-item expanded "><a href="../../../src/integrations/curve/OnlyBoostAllocator.sol/contract.OnlyBoostAllocator.html"><strong aria-hidden="true">1.1.6.</strong> OnlyBoostAllocator</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../src/interfaces/index.html"><strong aria-hidden="true">2.</strong> interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/interfaces/IAccountant.sol/interface.IAccountant.html"><strong aria-hidden="true">2.1.</strong> IAccountant</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IAllocator.sol/interface.IAllocator.html"><strong aria-hidden="true">2.2.</strong> IAllocator</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IBalanceProvider.sol/interface.IBalanceProvider.html"><strong aria-hidden="true">2.3.</strong> IBalanceProvider</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IFactory.sol/interface.IFactory.html"><strong aria-hidden="true">2.4.</strong> IFactory</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IProtocolController.sol/interface.IProtocolController.html"><strong aria-hidden="true">2.5.</strong> IProtocolController</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IRewardReceiver.sol/interface.IRewardReceiver.html"><strong aria-hidden="true">2.6.</strong> IRewardReceiver</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IRewardVault.sol/interface.IRewardVault.html"><strong aria-hidden="true">2.7.</strong> IRewardVault</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IRouter.sol/interface.IRouter.html"><strong aria-hidden="true">2.8.</strong> IRouter</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IRouterModule.sol/interface.IRouterModule.html"><strong aria-hidden="true">2.9.</strong> IRouterModule</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/ISidecar.sol/interface.ISidecar.html"><strong aria-hidden="true">2.10.</strong> ISidecar</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/ISidecarFactory.sol/interface.ISidecarFactory.html"><strong aria-hidden="true">2.11.</strong> ISidecarFactory</a></li><li class="chapter-item expanded "><a href="../../../src/interfaces/IStrategy.sol/interface.IStrategy.html"><strong aria-hidden="true">2.12.</strong> IStrategy</a></li></ol></li><li class="chapter-item expanded "><a href="../../../src/libraries/index.html"><strong aria-hidden="true">3.</strong> libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/libraries/ImmutableArgsParser.sol/library.ImmutableArgsParser.html"><strong aria-hidden="true">3.1.</strong> ImmutableArgsParser</a></li></ol></li><li class="chapter-item expanded "><a href="../../../src/merkl/index.html"><strong aria-hidden="true">4.</strong> merkl</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/merkl/UniversalBoostRegistry.sol/contract.UniversalBoostRegistry.html" class="active"><strong aria-hidden="true">4.1.</strong> UniversalBoostRegistry</a></li></ol></li><li class="chapter-item expanded "><a href="../../../src/router/index.html"><strong aria-hidden="true">5.</strong> router</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../src/router/RouterIdentifierMapping.sol/library.RouterIdentifierMapping.html"><strong aria-hidden="true">5.1.</strong> RouterIdentifierMapping</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleClaim.sol/contract.RouterModuleClaim.html"><strong aria-hidden="true">5.2.</strong> RouterModuleClaim</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleDeposit.sol/contract.RouterModuleDeposit.html"><strong aria-hidden="true">5.3.</strong> RouterModuleDeposit</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleMigrationCurve.sol/contract.RouterModuleMigrationCurve.html"><strong aria-hidden="true">5.4.</strong> RouterModuleMigrationCurve</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleMigrationStakeDAOV1.sol/interface.IVault.html"><strong aria-hidden="true">5.5.</strong> IVault</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleMigrationStakeDAOV1.sol/contract.RouterModuleMigrationStakeDAOV1.html"><strong aria-hidden="true">5.6.</strong> RouterModuleMigrationStakeDAOV1</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleMigrationYearn.sol/contract.RouterModuleMigrationYearn.html"><strong aria-hidden="true">5.7.</strong> RouterModuleMigrationYearn</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleMigrationYearn.sol/interface.IYearnVault.html"><strong aria-hidden="true">5.8.</strong> IYearnVault</a></li><li class="chapter-item expanded "><a href="../../../src/router/RouterModuleWithdraw.sol/contract.RouterModuleWithdraw.html"><strong aria-hidden="true">5.9.</strong> RouterModuleWithdraw</a></li></ol></li><li class="chapter-item expanded "><a href="../../../src/Accountant.sol/contract.Accountant.html"><strong aria-hidden="true">6.</strong> Accountant</a></li><li class="chapter-item expanded "><a href="../../../src/Allocator.sol/contract.Allocator.html"><strong aria-hidden="true">7.</strong> Allocator</a></li><li class="chapter-item expanded "><a href="../../../src/Factory.sol/abstract.Factory.html"><strong aria-hidden="true">8.</strong> Factory</a></li><li class="chapter-item expanded "><a href="../../../src/ProtocolContext.sol/contract.ProtocolContext.html"><strong aria-hidden="true">9.</strong> ProtocolContext</a></li><li class="chapter-item expanded "><a href="../../../src/ProtocolController.sol/contract.ProtocolController.html"><strong aria-hidden="true">10.</strong> ProtocolController</a></li><li class="chapter-item expanded "><a href="../../../src/RewardReceiver.sol/contract.RewardReceiver.html"><strong aria-hidden="true">11.</strong> RewardReceiver</a></li><li class="chapter-item expanded "><a href="../../../src/RewardReceiverL2.sol/contract.RewardReceiverL2.html"><strong aria-hidden="true">12.</strong> RewardReceiverL2</a></li><li class="chapter-item expanded "><a href="../../../src/RewardVault.sol/contract.RewardVault.html"><strong aria-hidden="true">13.</strong> RewardVault</a></li><li class="chapter-item expanded "><a href="../../../src/Router.sol/contract.Router.html"><strong aria-hidden="true">14.</strong> Router</a></li><li class="chapter-item expanded "><a href="../../../src/Sidecar.sol/abstract.Sidecar.html"><strong aria-hidden="true">15.</strong> Sidecar</a></li><li class="chapter-item expanded "><a href="../../../src/SidecarFactory.sol/abstract.SidecarFactory.html"><strong aria-hidden="true">16.</strong> SidecarFactory</a></li><li class="chapter-item expanded "><a href="../../../src/Strategy.sol/abstract.Strategy.html"><strong aria-hidden="true">17.</strong> Strategy</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Stake DAO Staking v2</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/stake-dao/contracts-monorepo" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="universalboostregistry"><a class="header" href="#universalboostregistry">UniversalBoostRegistry</a></h1>
<p><a href="https://github.com/stake-dao/contracts-monorepo/blob/6463f841c19032df5ad34b94117fb905366bc926/src/merkl/UniversalBoostRegistry.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Ownable2Step</p>
<p>A registry to keep track of the Boosts rented by the users, per protocol, to work with Merkl.</p>
<p>*Merkl will use this registry to know which Boosts are rented by the users, per protocol, and allocate according rewards,
minus the protocol fees (if any), set by this contract.
Key responsibilities:</p>
<ul>
<li>Tracks boost rental status for users across different protocols</li>
<li>Manages protocol-specific fee configurations with time-delayed updates</li>
<li>Provides a secure fee update mechanism with owner controls and delay periods</li>
<li>Integrates with Merkl for reward distribution calculations
The contract implements a two-phase fee update system:</li>
</ul>
<ol>
<li>Queue: Owner queues new protocol configurations</li>
<li>Commit: After delay period, configurations can be committed to take effect*</li>
</ol>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="max_fee_percent"><a class="header" href="#max_fee_percent">MAX_FEE_PERCENT</a></h3>
<p>The maximum fee percent (40%).</p>
<pre><code class="language-solidity">uint128 public constant MAX_FEE_PERCENT = 0.4e18;
</code></pre>
<h3 id="delayperiod"><a class="header" href="#delayperiod">delayPeriod</a></h3>
<p>Delay period for new fees to take effect.</p>
<p><em>This prevents immediate fee changes and provides users time to react to fee updates.</em></p>
<pre><code class="language-solidity">uint64 public delayPeriod = 1 days;
</code></pre>
<h3 id="queueddelayperiod"><a class="header" href="#queueddelayperiod">queuedDelayPeriod</a></h3>
<p>Queued delay period that will become active after commitment.</p>
<pre><code class="language-solidity">uint64 public queuedDelayPeriod;
</code></pre>
<h3 id="delayperiodqueuedtimestamp"><a class="header" href="#delayperiodqueuedtimestamp">delayPeriodQueuedTimestamp</a></h3>
<p>Timestamp when the queued delay period can be committed.</p>
<pre><code class="language-solidity">uint64 public delayPeriodQueuedTimestamp;
</code></pre>
<h3 id="protocolconfig"><a class="header" href="#protocolconfig">protocolConfig</a></h3>
<p>Mapping of protocol ID to protocol configuration.</p>
<p><em>Contains both active and queued configurations in a single mapping.
Use queuedTimestamp to determine if a configuration is pending.</em></p>
<pre><code class="language-solidity">mapping(bytes4 protocolId =&gt; ProtocolConfig config) public protocolConfig;
</code></pre>
<h3 id="isrentingboost"><a class="header" href="#isrentingboost">isRentingBoost</a></h3>
<p>Mapping of account to protocol ID to boost rental status.</p>
<p><em>Tracks whether a user has rented a boost for a specific protocol.
True means the user is currently renting a boost, false means they are not.</em></p>
<pre><code class="language-solidity">mapping(address account =&gt; mapping(bytes4 protocolId =&gt; bool status)) public isRentingBoost;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<p>Initializes the UniversalBoostRegistry contract.</p>
<p><em>Sets the deployer as the initial owner using Ownable2Step pattern.</em></p>
<pre><code class="language-solidity">constructor(address initialOwner) Ownable(initialOwner);
</code></pre>
<h3 id="rentboost"><a class="header" href="#rentboost">rentBoost</a></h3>
<p>Rents a boost for a given protocol.</p>
<p><em>Updates the rental status to true and emits a BoostRented event.
This function can be called by any user to rent a boost for themselves.</em></p>
<pre><code class="language-solidity">function rentBoost(bytes4 protocolId) public;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which to rent the boost.</td></tr>
</tbody></table>
</div>
<h3 id="returnboost"><a class="header" href="#returnboost">returnBoost</a></h3>
<p>Returns a boost for a given protocol.</p>
<p><em>Updates the rental status to false and emits a BoostReturned event.
This function can be called by any user to return their rented boost.</em></p>
<pre><code class="language-solidity">function returnBoost(bytes4 protocolId) public;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which to return the boost.</td></tr>
</tbody></table>
</div>
<h3 id="queuenewprotocolconfig"><a class="header" href="#queuenewprotocolconfig">queueNewProtocolConfig</a></h3>
<p>Queues a new protocol config for a given protocol ID.</p>
<p><em>Implements the first phase of the two-phase fee update mechanism.
Only the owner can queue new configurations. The configuration will not
take effect immediately - it must be committed after the delay period.
Preserves active configuration values until commitment.</em></p>
<p><strong>Notes:</strong></p>
<ul>
<li>
<p>throws: OwnableUnauthorizedAccount If caller is not the owner.</p>
</li>
<li>
<p>throws: FeeExceedsMaximum If the protocol fee exceeds the maximum allowed.</p>
</li>
</ul>
<pre><code class="language-solidity">function queueNewProtocolConfig(bytes4 protocolId, uint128 protocolFees) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which to queue the new configuration.</td></tr>
<tr><td><code>protocolFees</code></td><td><code>uint128</code></td><td>The protocol fee percentage to queue (scaled by 1e18).</td></tr>
</tbody></table>
</div>
<h3 id="setfeereceiver"><a class="header" href="#setfeereceiver">setFeeReceiver</a></h3>
<p>Set a new fee receiver for a given protocol.</p>
<p><em>This function can only be called by the owner.</em></p>
<pre><code class="language-solidity">function setFeeReceiver(bytes4 protocolId, address feeReceiver) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which to set the new fee receiver.</td></tr>
<tr><td><code>feeReceiver</code></td><td><code>address</code></td><td>The new fee receiver address.</td></tr>
</tbody></table>
</div>
<h3 id="queuedelayperiod"><a class="header" href="#queuedelayperiod">queueDelayPeriod</a></h3>
<p>Queues a new delay period.</p>
<p><em>This function can only be called by the owner. The new delay period
will only take effect after the current delay period has passed.
This prevents bypassing the delay mechanism by reducing the delay period.</em></p>
<pre><code class="language-solidity">function queueDelayPeriod(uint64 newDelayPeriod) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newDelayPeriod</code></td><td><code>uint64</code></td><td>The new delay period to queue.</td></tr>
</tbody></table>
</div>
<h3 id="commitdelayperiod"><a class="header" href="#commitdelayperiod">commitDelayPeriod</a></h3>
<p>Commits the queued delay period.</p>
<p><em>Can be called by anyone once the delay period has passed.</em></p>
<pre><code class="language-solidity">function commitDelayPeriod() public;
</code></pre>
<h3 id="commitprotocolconfig"><a class="header" href="#commitprotocolconfig">commitProtocolConfig</a></h3>
<p>Commits a new protocol config for a given protocol ID.</p>
<p><em>Implements the second phase of the two-phase fee update mechanism.
Can only be called after the delay period has passed since the configuration was queued.
This function can be called by anyone once the delay period has elapsed.
Moves queued values to active values and clears the queue.</em></p>
<p><strong>Notes:</strong></p>
<ul>
<li>
<p>throws: DelayPeriodNotPassed If the delay period since queuing hasn't elapsed.</p>
</li>
<li>
<p>throws: NoQueuedConfig If there is no queued configuration to commit.</p>
</li>
</ul>
<pre><code class="language-solidity">function commitProtocolConfig(bytes4 protocolId) public;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which to commit the new configuration.</td></tr>
</tbody></table>
</div>
<h3 id="hasqueuedconfig"><a class="header" href="#hasqueuedconfig">hasQueuedConfig</a></h3>
<p>Returns whether a protocol configuration is currently queued and pending.</p>
<pre><code class="language-solidity">function hasQueuedConfig(bytes4 protocolId) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID to check.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>_ True if there is a queued configuration pending commitment.</td></tr>
</tbody></table>
</div>
<h3 id="getcommittimestamp"><a class="header" href="#getcommittimestamp">getCommitTimestamp</a></h3>
<p>Returns the timestamp when a configuration can be committed.</p>
<pre><code class="language-solidity">function getCommitTimestamp(bytes4 protocolId) external view returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID to check.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>_ The timestamp when the configuration can be committed (0 if no queued config).</td></tr>
</tbody></table>
</div>
<h3 id="hasqueueddelayperiod"><a class="header" href="#hasqueueddelayperiod">hasQueuedDelayPeriod</a></h3>
<p>Returns whether a delay period is currently queued and pending.</p>
<pre><code class="language-solidity">function hasQueuedDelayPeriod() external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>_ True if there is a queued delay period pending commitment.</td></tr>
</tbody></table>
</div>
<h3 id="getdelayperiodcommittimestamp"><a class="header" href="#getdelayperiodcommittimestamp">getDelayPeriodCommitTimestamp</a></h3>
<p>Returns the timestamp when the queued delay period can be committed.</p>
<pre><code class="language-solidity">function getDelayPeriodCommitTimestamp() external view returns (uint64);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>_ The timestamp when the delay period can be committed (0 if no queued delay period).</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="boostrented"><a class="header" href="#boostrented">BoostRented</a></h3>
<p>Event emitted when a boost is rented.</p>
<pre><code class="language-solidity">event BoostRented(address indexed account, bytes4 indexed protocolId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>account</code></td><td><code>address</code></td><td>The address that rented the boost.</td></tr>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which the boost was rented.</td></tr>
</tbody></table>
</div>
<h3 id="boostreturned"><a class="header" href="#boostreturned">BoostReturned</a></h3>
<p>Event emitted when a boost is returned.</p>
<pre><code class="language-solidity">event BoostReturned(address indexed account, bytes4 indexed protocolId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>account</code></td><td><code>address</code></td><td>The address that returned the boost.</td></tr>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which the boost was returned.</td></tr>
</tbody></table>
</div>
<h3 id="newprotocolconfigqueued"><a class="header" href="#newprotocolconfigqueued">NewProtocolConfigQueued</a></h3>
<p>Event emitted when a new protocol config is queued.</p>
<pre><code class="language-solidity">event NewProtocolConfigQueued(bytes4 indexed protocolId, uint128 protocolFees, uint64 queuedTimestamp);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which the config was queued.</td></tr>
<tr><td><code>protocolFees</code></td><td><code>uint128</code></td><td>The queued protocol fee percentage.</td></tr>
<tr><td><code>queuedTimestamp</code></td><td><code>uint64</code></td><td>The timestamp when the configuration was queued.</td></tr>
</tbody></table>
</div>
<h3 id="protocolconfigcommitted"><a class="header" href="#protocolconfigcommitted">ProtocolConfigCommitted</a></h3>
<p>Event emitted when a protocol config is committed.</p>
<pre><code class="language-solidity">event ProtocolConfigCommitted(bytes4 indexed protocolId, uint128 protocolFees, uint64 committedTimestamp);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocolId</code></td><td><code>bytes4</code></td><td>The protocol ID for which the config was committed.</td></tr>
<tr><td><code>protocolFees</code></td><td><code>uint128</code></td><td>The committed protocol fee percentage.</td></tr>
<tr><td><code>committedTimestamp</code></td><td><code>uint64</code></td><td>The timestamp when the configuration was committed.</td></tr>
</tbody></table>
</div>
<h3 id="delayperiodqueued"><a class="header" href="#delayperiodqueued">DelayPeriodQueued</a></h3>
<p>Event emitted when a new delay period is queued.</p>
<pre><code class="language-solidity">event DelayPeriodQueued(uint64 newDelayPeriod, uint64 queuedTimestamp);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newDelayPeriod</code></td><td><code>uint64</code></td><td>The new delay period.</td></tr>
<tr><td><code>queuedTimestamp</code></td><td><code>uint64</code></td><td>The timestamp when it can be committed.</td></tr>
</tbody></table>
</div>
<h3 id="delayperiodcommitted"><a class="header" href="#delayperiodcommitted">DelayPeriodCommitted</a></h3>
<p>Event emitted when the delay period is committed.</p>
<pre><code class="language-solidity">event DelayPeriodCommitted(uint64 newDelayPeriod, uint64 committedTimestamp);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newDelayPeriod</code></td><td><code>uint64</code></td><td>The new delay period.</td></tr>
<tr><td><code>committedTimestamp</code></td><td><code>uint64</code></td><td>The timestamp when it was committed.</td></tr>
</tbody></table>
</div>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="noqueuedconfig"><a class="header" href="#noqueuedconfig">NoQueuedConfig</a></h3>
<p>Error thrown when there is no queued configuration to commit.</p>
<pre><code class="language-solidity">error NoQueuedConfig();
</code></pre>
<h3 id="feeexceedsmaximum"><a class="header" href="#feeexceedsmaximum">FeeExceedsMaximum</a></h3>
<p>Error thrown when a fee exceeds the maximum allowed.</p>
<pre><code class="language-solidity">error FeeExceedsMaximum();
</code></pre>
<h3 id="delayperiodnotpassed"><a class="header" href="#delayperiodnotpassed">DelayPeriodNotPassed</a></h3>
<p>Error thrown when the delay period for new fees to take effect has not passed.</p>
<pre><code class="language-solidity">error DelayPeriodNotPassed();
</code></pre>
<h3 id="noqueueddelayperiod"><a class="header" href="#noqueueddelayperiod">NoQueuedDelayPeriod</a></h3>
<p>Error thrown when there is no queued delay period to commit.</p>
<pre><code class="language-solidity">error NoQueuedDelayPeriod();
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="protocolconfig-1"><a class="header" href="#protocolconfig-1">ProtocolConfig</a></h3>
<p>Configuration parameters for a specific protocol.</p>
<p><em>Contains both active and queued fee configurations with timestamps for delay mechanism.
Optimized for gas efficiency by packing fields into 3 storage slots instead of 6.
Active values are used for current operations, queued values become active after commitment.</em></p>
<pre><code class="language-solidity">struct ProtocolConfig {
    uint128 protocolFees;
    uint128 queuedProtocolFees;
    uint64 lastUpdated;
    uint64 queuedTimestamp;
    address feeReceiver;
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../src/merkl/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../src/router/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../src/merkl/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../src/router/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../solidity.min.js"></script>


    </div>
    </body>
</html>
